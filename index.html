



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://djangomadrid.github.io/workshop/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Taller de Introducción a Django</title>
      
    
    
<style>
  /* 4 gatitos murieron, uno por cada !important */
  .md-header {
    background-color: #092e20 !important;
  }
  .md-nav__title {
    padding: 0 0.6rem !important;
    height: auto !important;
  }
  .md-nav__title:before {
    content: none !important;
  }
</style>

      <link rel="stylesheet" href="assets/stylesheets/application.30686662.css">
      
      
    

    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-19120546-16", {
    'storage': 'none'
  })
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#taller-de-introduccion-a-django" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://djangomadrid.github.io/workshop" title="Taller de Introducción a Django" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            Taller de Introducción a Django
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/DjangoMadrid/workshop/" title="Ir al repositorio" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    DjangoMadrid/workshop
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
  <div class="md-sidebar__scrollwrap">
    <div class="md-sidebar__inner">
      <nav class="md-nav md-nav--primary" data-md-level="0">
        
          <div class="md-nav__source">
            


  

<a href="https://github.com/DjangoMadrid/workshop/" title="Ir al repositorio" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    DjangoMadrid/workshop
  </div>
</a>
          </div>
        
        <ul class="md-nav__list" data-md-scrollfix>
          
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requisitos" class="md-nav__link">
    Requisitos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalacion" class="md-nav__link">
    Instalación
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#django" class="md-nav__link">
    Django
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proyecto" class="md-nav__link">
    Proyecto
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vistas" class="md-nav__link">
    Vistas
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aplicacion" class="md-nav__link">
    Aplicación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista" class="md-nav__link">
    Vista
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plantilla-html" class="md-nav__link">
    Plantilla HTML
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelos" class="md-nav__link">
    Modelos
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migraciones" class="md-nav__link">
    Migraciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crear-actualizar-y-borrar" class="md-nav__link">
    Crear, actualizar y borrar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manager" class="md-nav__link">
    Manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#administracion" class="md-nav__link">
    Administración
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integracion-con-el-modelo" class="md-nav__link">
    Integración con el modelo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    Tests
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tests-para-la-vista" class="md-nav__link">
    Tests para la vista
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejecucion" class="md-nav__link">
    Ejecución
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#siguientes-pasos" class="md-nav__link">
    Siguientes pasos
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#para-leer-mas" class="md-nav__link">
    Para leer más
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
        </ul>
      </nav>
    </div>
  </div>
</div>

          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/DjangoMadrid/workshop/edit/master/docs/index.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="taller-de-introduccion-a-django">Taller de Introducción a Django<a class="headerlink" href="#taller-de-introduccion-a-django" title="Permanent link">&para;</a></h1>
<p>El taller está pensado para iniciarse en Django en aproximadamente <strong>una hora</strong>.</p>
<h2 id="requisitos">Requisitos<a class="headerlink" href="#requisitos" title="Permanent link">&para;</a></h2>
<p>Requiere tener <a href="https://www.python.org/downloads/">Python 3 instalado</a>, y un conocimiento básico tanto de Python como de tecnologías web (HTTP y HTML).</p>
<h2 id="instalacion">Instalación<a class="headerlink" href="#instalacion" title="Permanent link">&para;</a></h2>
<h3 id="django">Django<a class="headerlink" href="#django" title="Permanent link">&para;</a></h3>
<p>Primero, <strong>instalaremos el paquete <code>Django</code></strong> a través de <code>pip</code>, el instalador de paquetes de Python (viene por defecto incluido en su instalación):</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>pip3 install Django
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Max OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>pip3 install Django
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_2" />
<label for="__tab_1_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">Django</span>
</pre></div></div>
</div>
<h3 id="proyecto">Proyecto<a class="headerlink" href="#proyecto" title="Permanent link">&para;</a></h3>
<p>En Django, un <strong>proyecto</strong> o <em>project</em> es un conjunto de carpetas y archivos (un <em>esqueleto</em>) donde desarrollaremos el sitio web.</p>
<p>Vamos a <strong>crear un proyecto</strong> de Django e <strong>iniciar el <a href="https://docs.djangoproject.com/es/stable/intro/tutorial01/#the-development-server">servidor de desarrollo</a></strong>:</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>django-admin startproject mysite
<span class="nb">cd</span> mysite
python3 manage.py runserver
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>django-admin startproject mysite
<span class="nb">cd</span> mysite
python3 manage.py runserver
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_2" />
<label for="__tab_2_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">django-admin</span><span class="p">.</span><span class="n">exe</span> <span class="n">startproject</span> <span class="n">mysite</span>
<span class="nb">cd </span><span class="n">mysite</span>
<span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">runserver</span>
</pre></div></div>
</div>
<p>Con ésto habremos creado un un nuevo proyecto Django llamado <code>mysite</code>, y el servidor de desarrollo estará corriendo en el puerto por defecto (8000).</p>
<p>En nuestro navegador <strong>abrimos <a href="http://127.0.0.1:8000">127.0.0.1:8000</a></strong> y confirmamos que estamos viendo la página inicial del proyecto, que tendrá el siguiente mensaje:</p>
<blockquote>
<p>The install worked successfully! Congratulations!</p>
</blockquote>
<p>Abre la carpeta con tu editor de código favorito. Verás los siguientes archivos:</p>
<ul>
<li><code>db.sqlite3</code>: Base de datos por defecto, en <a href="https://www.sqlite.org">SQLite 3</a>.</li>
<li><code>manage.py</code>: Ejecutable para administrar el proyecto. Con él hemos iniciado el servidor de desarrollo.</li>
<li><code>mysite</code>: Módulo que engloba diferentes funcionalidades a nivel de proyecto.<ul>
<li><code>settings.py</code>: Contiene la configuración. Entre otras cosas, define la base de datos.</li>
<li><code>urls.py</code>: Contiene la lista de URLs mapeadas a la lógica.</li>
<li><code>wsgi.py</code>: Define la <a href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface">Web Server Gateway Interface</a> que usaríamos en producción. Podemos ignorarlo para este taller.</li>
</ul>
</li>
</ul>
<h2 id="vistas">Vistas<a class="headerlink" href="#vistas" title="Permanent link">&para;</a></h2>
<p>Las <strong>vistas</strong> o <em>views</em> en Django son funciones Python que procesan las peticiones HTTP. Serían el <em>controlador</em> en el patrón de arquitectura <a href="https://es.wikipedia.org/wiki/Modelo%E2%80%93vista%E2%80%93controlador">Modelo-Vista-Controlador</a> (en Django <a href="https://docs.djangoproject.com/es/stable/faq/general/#django-appears-to-be-a-mvc-framework-but-you-call-the-controller-the-view-and-the-view-the-template-how-come-you-don-t-use-the-standard-names">la nomenclatura es diferente</a>).</p>
<p>Para crear una vista, primero necesitamos una <strong>aplicación</strong> en la que definirla.</p>
<h3 id="aplicacion">Aplicación<a class="headerlink" href="#aplicacion" title="Permanent link">&para;</a></h3>
<p>Las aplicaciones son un módulo de Python que reunirá un conjunto de funcionalidades (lógica, modelos, etc). Además, podremos <a href="https://djangopackages.org/categories/apps/">reutilizarlas en otros proyectos</a>.</p>
<p>Vamos a crear una aplicación de ejemplo para gestionar notas. Abre un nuevo terminal para dejar el servidor de desarrollo corriendo y poder seguir ejecutando comandos. Ahora ejecutamos <code>manage.py startapp</code> para crear una aplicación que llamaremos <code>notes</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py startapp notes
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py startapp notes
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_2" />
<label for="__tab_3_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">startapp</span> <span class="n">notes</span>
</pre></div></div>
</div>
<p>El comando creará un modulo con los siguientes archivos:</p>
<ul>
<li><code>admin.py</code>: Integración con el panel administrativo de Django.</li>
<li><code>apps.py</code>: Propiedades de la aplicación (por ejemplo el nombre).</li>
<li><code>migrations/</code>: Carpeta que contendrá las futuras migraciones de la base de datos.</li>
<li><code>models.py</code>: Definición de los modelos del <a href="https://es.wikipedia.org/wiki/Mapeo_objeto-relacional">ORM</a> de Django.</li>
<li><code>tests.py</code>: Definición de los tests.</li>
<li><code>views.py</code>: Definición de las <strong>vistas</strong>.</li>
</ul>
<p>Para acabar, vamos a <em>instalar</em> la aplicación en el proyecto. Ésto nos permitirá integrarla más adelante con muchas de las funcionalidades de Django, como el ORM o el motor de plantillas (<a href="https://docs.djangoproject.com/es/stable/ref/templates/language/"><em>templates</em></a>). Abre <code>mysite/settings.py</code> con tu <a href="https://tutorial.djangogirls.org/es/code_editor/">editor de código favorito</a> y añade <code>notes</code> (el nombre de la aplicación) a la lista de <code>INSTALLED_APPS</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="hll">    <span class="s1">&#39;notes&#39;</span><span class="p">,</span>
</span><span class="p">]</span>
</pre></div>

<h3 id="vista">Vista<a class="headerlink" href="#vista" title="Permanent link">&para;</a></h3>
<p>En Django, una vista es una función que <a href="https://docs.djangoproject.com/es/stable/ref/request-response/">recibe un objeto <code>HttpRequest</code> y devuelve un objeto <code>HttpResponse</code></a>. Por ejemplo:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>
</pre></div>

<p>Ésta vista devolvería una respuesta en <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Basics_of_HTTP/MIME_types#textplain">texto plano</a>. Pero nosotros vamos a definir una vista que devuelva <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Basics_of_HTTP/MIME_types#texthtml">texto HTML</a>.</p>
<p>Abre <code>notes/views.py</code> y define la siguiente vista:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>
<span class="hll">    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">        <span class="s1">&#39;note_list&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">            <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Sin noticias de Gurb&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;Libro de Eduardo Mendoza&#39;</span><span class="p">},</span>
</span><span class="hll">            <span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;¿Qué hace un perro con un taladro?&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;Taladrando&#39;</span><span class="p">},</span>
</span><span class="hll">        <span class="p">]</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="hll">    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="n">response</span>
</span></pre></div>

<p>El método <a href="https://docs.djangoproject.com/es/stable/topics/templates/#django.template.backends.base.Template.render"><code>render</code></a> pinta una plantilla (<em>template</em>) HTML usando <a href="https://docs.djangoproject.com/es/stable/ref/templates/language/">el motor de plantillas de Django</a> y devuelve el resultado como un objeto <code>HttpResponse</code>. Recuerda que en Django las vistas deben devolver una instancia de esta clase.</p>
<p>Veamos que parámetros pasamos a <code>render</code>:
- En <code>template</code> pasamos <code>notes/index.html</code>, que es el fichero con la plantilla HTML a pintar. Lo crearemos en la sección siguiente.
- En <code>context</code> pasamos un <a href="https://docs.python.org/3.5/library/stdtypes.html#typesmapping">mapa (<code>dict</code>)</a> con una serie de valores a ser usados por la plantilla. En este caso hemos definido una lista arbitraria de notas, y cada una de ellas es a su vez otro mapa con un título y un contenido.</p>
<h3 id="plantilla-html">Plantilla HTML<a class="headerlink" href="#plantilla-html" title="Permanent link">&para;</a></h3>
<p>Ahora, vamos a crear la <strong>plantilla HTML</strong>. Por defecto, <a href="https://docs.djangoproject.com/es/stable/topics/templates/#django.template.backends.django.DjangoTemplates">Django busca plantillas en la carpeta <code>templates</code> de cada aplicación instalada</a>. Así que vamos a crear una carpeta llamada <code>templates</code> dentro de <code>mysite/notes/</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_4" type="radio" id="__tab_4_0" checked="checked" />
<label for="__tab_4_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>mkdir notes/templates
</pre></div></div>
<input name="__tabs_4" type="radio" id="__tab_4_1" />
<label for="__tab_4_1">Max OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>mkdir notes/templates
</pre></div></div>
<input name="__tabs_4" type="radio" id="__tab_4_2" />
<label for="__tab_4_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">mkdir</span> <span class="n">notes</span><span class="p">/</span><span class="n">templates</span>
</pre></div></div>
</div>
<p>Y ahora en esa carpeta crea un nuevo archivo <code>index.html</code> (la ruta completa sería <code>notes/templates/index.html</code>) con el siguiente contenido:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Notas<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Notas<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    {% for note in note_list %}
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{ note.title }}<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ note.content }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    {% endfor %}
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>

<p>La plantilla imprimirá un documento HTML con los títulos y el contenido de las notas que hemos pasado en el <em>contexto</em>, gracias al bucle <code>for</code>.</p>
<p>En el lenguaje de plantillas de Django, podemos imprimir las variables recibidas del <em>contexto</em> envolviéndolas entre <code>{{</code> y <code>}}</code>.</p>
<p>Además, podemos usar controles de flujo básicos (como <code>for</code>, <code>if</code>, etc) usando lo que en Django se denominan <a href="https://docs.djangoproject.com/es/stable/ref/templates/language/#tags"><code>tags</code></a>. La sintaxis puede variar, pero siempre estará envuelta entre <code>{%</code> y <code>%}</code>.</p>
<h3 id="url">URL<a class="headerlink" href="#url" title="Permanent link">&para;</a></h3>
<p>Por último, debemos <strong>mapear una URL a la vista</strong> que hemos definido. Para ello, añadiremos una ruta (<a href="https://docs.djangoproject.com/en/stable/ref/urls/#path"><code>path</code></a>) a la lista <code>urlpatterns</code> de <code>mysite/urls.py</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="hll"><span class="kn">from</span> <span class="nn">notes</span> <span class="kn">import</span> <span class="n">views</span>
</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="hll">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
</span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>

<p>Hemos mapeado la vista a la ruta raíz <code>''</code>, de forma que si ahora refrescamos la página <a href="http://127.0.0.1:8000">127.0.0.1:8000</a>, veremos el resultado. Si lo hubiésemos mapeado tal que <code>path('notes', views.index)</code>, la URL sería <code>127.0.0.1:8000/notas</code>.</p>
<p>Fíjate que el servidor de desarrollo ha detectado las modificaciones y se ha reiniciado automáticamente, aplicando los cambios sin necesidad de apagarlo y volverlo a encender manualmente.</p>
<h2 id="modelos">Modelos<a class="headerlink" href="#modelos" title="Permanent link">&para;</a></h2>
<p>En Django, los <strong>modelos</strong> son la única fuente de información de tus datos. Con ellos:
- Definimos su <a href="https://es.wikipedia.org/wiki/Esquema_de_una_base_de_datos">esquema</a>.
- Gestionamos los cambios del esquema (<a href="https://en.wikipedia.org/wiki/Schema_migration"><em>migraciones</em></a>).
- Consultamos y manipulamos los registros.</p>
<p>Los modelos implementan el patrón <a href="https://es.wikipedia.org/wiki/Mapeo_objeto-relacional">ORM</a>. Django trabaja con <a href="https://es.wikipedia.org/wiki/Base_de_datos_relacional">bases de datos relacionales</a>. Recuerda que por defecto utiliza <a href="https://www.sqlite.org">SQLite 3</a>. Simplificando, podemos pensar que las bases de datos relacionales almacenan la información en tablas (<em>esquemas</em>), donde las columnas son las propiedades y las filas cada uno de los registros.</p>
<p>En nuestro proyecto en concreto, podríamos almacenar las notas en una tabla con las columnas "título" y "contenido" (<code>title</code> y <code>content</code>), donde las filas serían cada una de nuestras notas. Vamos a definir un modelo para ello. Abre el archivo <code>notes/models.py</code> y añade las siguientes líneas:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>


<span class="hll"><span class="k">class</span> <span class="nc">Note</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span><span class="hll">    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</span></pre></div>

<p>En Django, los modelos deben extender <code>models.Model</code>. Las clases <code>CharField</code> y <code>TextField</code> son algunos de los campos que podemos definir en nuestro modelo, pero <a href="https://docs.djangoproject.com/es/stable/ref/models/fields">hay muchos más</a>.</p>
<p>Fíjate que hemos sobreescrito el método mágico de Python <a href="https://docs.python.org/3/reference/datamodel.html?#object.__str__"><code>__str__</code></a>. Django utilizará éste método en <a href="https://docs.djangoproject.com/es/stable/ref/models/instances/#str">diversos sitios</a>, y además facilitará la depuración de la aplicación. Si no lo sobreescribimos, el modelo por defecto devolverá el <code>id</code> del registro.</p>
<h3 id="migraciones">Migraciones<a class="headerlink" href="#migraciones" title="Permanent link">&para;</a></h3>
<p>Tenemos el modelo pero, antes de ponernos a crear registros, tenemos que crear la tabla donde se van a guardar. Para los cambios de esquema usaremos <a href="https://docs.djangoproject.com/es/stable/topics/migrations/"><em>migraciones</em></a>. Django tiene un comando para crear migraciones, detectando automáticamente los cambios realizados en los modelos. Ejecuta el siguiente comando, que buscará estos cambios en la aplicación <code>notes</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_5" type="radio" id="__tab_5_0" checked="checked" />
<label for="__tab_5_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py makemigrations notes
</pre></div></div>
<input name="__tabs_5" type="radio" id="__tab_5_1" />
<label for="__tab_5_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py makemigrations notes
</pre></div></div>
<input name="__tabs_5" type="radio" id="__tab_5_2" />
<label for="__tab_5_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">makemigrations</span> <span class="n">notes</span>
</pre></div></div>
</div>
<p>Esto habrá creado un archivo de migración en <code>notes/migrations/0001_initial.py</code>. Si lo abres, podrás ver instrucciones para crear la tabla en la base de datos con los campos que hemos definido en el modelo. Fíjate que automáticamente ha añadido una clave primaria, llamada por defecto <code>id</code>, sin necesidad de declararla en el modelo. Todos los modelos de Django tienen implícitamente un campo <code>id</code>.</p>
<p>Para crear la tabla en la base de datos, ejecutamos el comando <code>migrate</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_6" type="radio" id="__tab_6_0" checked="checked" />
<label for="__tab_6_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py migrate notes
</pre></div></div>
<input name="__tabs_6" type="radio" id="__tab_6_1" />
<label for="__tab_6_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py migrate notes
</pre></div></div>
<input name="__tabs_6" type="radio" id="__tab_6_2" />
<label for="__tab_6_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">migrate</span> <span class="n">notes</span>
</pre></div></div>
</div>
<p>Este comando aplicará las migraciones pendientes de la aplicación <code>notes</code>. Django lleva un registro de las migraciones aplicadas en otra tabla creada por defecto.</p>
<p>Podemos abrir una consola en la base de datos del proyecto con el comando <code>dbshell</code>, y listar las tablas creadas con <a href="https://sqlite.org/cli.html#special_commands_to_sqlite3_dot_commands_"><code>.tables</code></a>:</p>
<div class="superfences-tabs">
<input name="__tabs_7" type="radio" id="__tab_7_0" checked="checked" />
<label for="__tab_7_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>$ python3 manage.py dbshell
SQLite version <span class="m">3</span>.24.0 <span class="m">2018</span>-06-04 <span class="m">14</span>:10:15
Enter <span class="s2">&quot;.help&quot;</span> <span class="k">for</span> usage hints.
sqlite&gt; .tables
django_migrations  notes_note
</pre></div></div>
<input name="__tabs_7" type="radio" id="__tab_7_1" />
<label for="__tab_7_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>$ python3 manage.py dbshell
SQLite version <span class="m">3</span>.24.0 <span class="m">2018</span>-06-04 <span class="m">14</span>:10:15
Enter <span class="s2">&quot;.help&quot;</span> <span class="k">for</span> usage hints.
sqlite&gt; .tables
django_migrations  notes_note
</pre></div></div>
<input name="__tabs_7" type="radio" id="__tab_7_2" />
<label for="__tab_7_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="p">$</span> <span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">dbshell</span>
<span class="n">SQLite</span> <span class="n">version</span> <span class="n">3</span><span class="p">.</span><span class="n">24</span><span class="p">.</span><span class="n">0</span> <span class="n">2018</span><span class="p">-</span><span class="n">06</span><span class="p">-</span><span class="n">04</span> <span class="n">14</span><span class="err">:</span><span class="n">10</span><span class="err">:</span><span class="n">15</span>
<span class="n">Enter</span> <span class="s2">&quot;.help&quot;</span> <span class="k">for</span> <span class="n">usage</span> <span class="n">hints</span><span class="p">.</span>
<span class="n">sqlite</span><span class="p">&gt;</span> <span class="p">.</span><span class="n">tables</span>
<span class="n">django_migrations</span>  <span class="n">notes_note</span>
</pre></div></div>
</div>
<p>Las tablas creadas por defecto en Django están formadas por el nombre de la aplicación, un guión bajo (<code>_</code>), y el nombre del modelo (en minúscula y sin espacios). Por eso la tabla se ha creado con el nombre <code>notes_note</code> (recuerda que la aplicación se llama <code>notes</code>, y el modelo <code>note</code>).</p>
<h3 id="crear-actualizar-y-borrar">Crear, actualizar y borrar<a class="headerlink" href="#crear-actualizar-y-borrar" title="Permanent link">&para;</a></h3>
<p>Para crear algunos registros de ejemplo vamos a abrir una consola interactiva (<a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>) de Django con el comando <code>shell</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_8" type="radio" id="__tab_8_0" checked="checked" />
<label for="__tab_8_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py shell
</pre></div></div>
<input name="__tabs_8" type="radio" id="__tab_8_1" />
<label for="__tab_8_1">Mac OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py shell
</pre></div></div>
<input name="__tabs_8" type="radio" id="__tab_8_2" />
<label for="__tab_8_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">shell</span>
</pre></div></div>
</div>
<p>Una vez dentro de la consola, importamos el modelo:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">notes.models</span> <span class="kn">import</span> <span class="n">Note</span>
</pre></div>

<p>Podemos crear registros instanciando la clase del modelo (en este caso <code>Note</code>) pasando sus valores al constructor, y posteriormente llamando al método <code>save</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">note</span> <span class="o">=</span> <span class="n">Note</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;El Guateque&#39;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="s1">&#39;Película sobre una animada fiesta&#39;</span><span class="p">)</span>
<span class="n">note</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

<p>El registro no se insertará en la base de datos hasta que llamemos a <code>save</code>, que al ser un registro nuevo ejecutará un <a href="https://www.w3schools.com/sql/sql_insert.asp"><code>INSERT</code></a>.</p>
<p>Podemos actualizar el registro cambiando el valor de sus atributos en la instancia y llamando de nuevo a <code>save</code>, el cual ésta vez realizará un <a href="https://www.w3schools.com/sql/sql_update.asp"><code>UPDATE</code></a>:</p>
<div class="codehilite"><pre><span></span><span class="n">note</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Pulp Fiction&quot;</span>
<span class="n">note</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

<p>Por último, podemos borrar el registro llamando a <code>delete</code>, el cual ejecutará un <a href="https://www.w3schools.com/sql/sql_delete.asp"><code>DELETE</code></a>.</p>
<div class="codehilite"><pre><span></span><span class="n">note</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

<p>No cierres la consola de Django, la necesitaremos para la sección siguiente.</p>
<h3 id="manager"><em>Manager</em><a class="headerlink" href="#manager" title="Permanent link">&para;</a></h3>
<p>En Django, los modelos tienen por defecto un <em><strong>manager</strong></em> para interactuar con la base de datos. Todos los modelos tienen un <em>manager</em> en el atributo de clase <a href="https://docs.djangoproject.com/es/stable/topics/db/models/#model-attributes"><code>objects</code></a>.</p>
<p>En los ejemplos anteriores, cuando llamamos a <code>save</code>, por debajo se está llamando al <em>manager</em> del modelo. Vamos a crear un par de registros de ejemplo usando directamente el <em>manager</em> desde la consola de Django:</p>
<div class="codehilite"><pre><span></span><span class="n">Note</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;El Guateque&#39;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="s1">&#39;Película sobre una animada fiesta&#39;</span><span class="p">)</span>
<span class="n">Note</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hyperion&#39;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="s1">&#39;Libro de Dan Simmons&#39;</span><span class="p">)</span>
</pre></div>

<p>Pero lo más importante es que <code>objects</code> nos va a permitir hacer consultas a la base de datos para leer los registros guardados. Ejecuta la siguiente línea para ver una lista con los registros que acabamos de crear:</p>
<div class="codehilite"><pre><span></span><span class="n">Note</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

<p><code>objects</code> ofrece <a href="https://docs.djangoproject.com/es/stable/ref/models/querysets/">muchos métodos para realizar consultas</a>, pero de momento nos quedamos con <code>all</code>, la cual devuelve todos los registros.</p>
<p>Cierra la <code>shell</code> de Django escribiendo <code>exit()</code>:</p>
<div class="codehilite"><pre><span></span><span class="nb">exit</span><span class="p">()</span>
</pre></div>

<p>Vamos a cambiar la vista <code>index</code> para que lea los registros de la base de datos. Abre <code>notes/views.py</code> y reemplaza el valor de <code>note_list</code> del contexto de la vista:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="hll"><span class="kn">from</span> <span class="nn">notes.models</span> <span class="kn">import</span> <span class="n">Notes</span>
</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
<span class="hll">        <span class="s1">&#39;note_list&#39;</span><span class="p">:</span> <span class="n">Notes</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span>    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

<p>Si ahora refrescamos la página <a href="http://127.0.0.1:8000">127.0.0.1:8000</a>, veremos que muestra los registros que hemos creado ("El Guateque" e "Hyperion").</p>
<h2 id="administracion">Administración<a class="headerlink" href="#administracion" title="Permanent link">&para;</a></h2>
<p>Django ofrece por defecto un panel de <a href="https://docs.djangoproject.com/es/stable/intro/tutorial02/#introducing-the-django-admin">administración</a> web que nos permitirá gestionar los registros de la base de datos fácilmente. Éste, a su vez, depende de otras aplicaciones que instala Django por defecto para gestionar usuarios y sesiones. Para empezar a usar la administración, primero debemos aplicar las migraciones de estos modelos. Ejecutemos el comando <code>migrate</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_9" type="radio" id="__tab_9_0" checked="checked" />
<label for="__tab_9_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py migrate
</pre></div></div>
<input name="__tabs_9" type="radio" id="__tab_9_1" />
<label for="__tab_9_1">Max OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py migrate
</pre></div></div>
<input name="__tabs_9" type="radio" id="__tab_9_2" />
<label for="__tab_9_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">migrate</span>
</pre></div></div>
</div>
<p>Veremos que ejecuta migraciones de diferentes aplicaciones. Ahora vamos a crear un usuario administrador para poder iniciar sesión en la administración. Ejecuta el comando <code>createsuperuser</code> y responde sus preguntas:</p>
<div class="superfences-tabs">
<input name="__tabs_10" type="radio" id="__tab_10_0" checked="checked" />
<label for="__tab_10_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py createsuperuser
</pre></div></div>
<input name="__tabs_10" type="radio" id="__tab_10_1" />
<label for="__tab_10_1">Max OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py createsuperuser
</pre></div></div>
<input name="__tabs_10" type="radio" id="__tab_10_2" />
<label for="__tab_10_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">createsuperuser</span>
</pre></div></div>
</div>
<p>Ahora abrimos la página de administración en <a href="http://127.0.0.1:8000/admin">127.0.0.1:8000/admin</a> e iniciamos sesión con el nombre de usuario y password que acabamos de crear. Verás que, entre otras cosas, puedes gestionar los usuarios desde ahí.</p>
<h3 id="integracion-con-el-modelo">Integración con el modelo<a class="headerlink" href="#integracion-con-el-modelo" title="Permanent link">&para;</a></h3>
<p>Vamos a registrar el modelo <code>Note</code> en la administración para que podamos gestionar los registros desde allí. Para ello, abrimos <code>notes/admin.py</code>, importamos el modelo <code>Note</code>, y lo regisramos con <code>admin.site.register</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

<span class="hll"><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Note</span>
</span>

<span class="hll"><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Note</span><span class="p">)</span>
</span></pre></div>

<p>Si refrescamos el panel de administración en <a href="http://127.0.0.1:8000/admin">127.0.0.1:8000/admin</a>, veremos que ahora podemos gestionar los registros del modelo desde allí. Prueba a añadir algunas notas de ejemplo usando la administración, vuelve a la <a href="http://127.0.0.1:8000">página raíz del proyecto</a>, y comprueba que se muestran correctamente.</p>
<h2 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h2>
<p>Para acabar, vamos a escribir algunos <a href="https://docs.djangoproject.com/es/stable/intro/tutorial05/">tests</a> para comprobar de forma automática el funcionamiento de la aplicación.</p>
<p>Django ofrece una clase <code>TestCase</code>, que extiende <a href="https://docs.python.org/3/library/unittest.html#unittest.TestCase"><code>unittest.TestCase</code></a> con algunas <a href="https://docs.djangoproject.com/en/stable/topics/testing/tools/#testcase">funcionalidades específicas</a> para escribir tests en Django. Una de las más importantes es que incluye un cliente (<code>self.client</code>) y un servidor para realizar peticiones a las vistas de la aplicación. Además, cada test estará envuelto en una transacción, de forma que podemos usar diferentes conjuntos de datos fácilmente.</p>
<h3 id="tests-para-la-vista">Tests para la vista<a class="headerlink" href="#tests-para-la-vista" title="Permanent link">&para;</a></h3>
<p>Abrimos <code>notes/tests.py</code> y añadimos los siguiente test:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="hll"><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Note</span>
</span><span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">IndexViewTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">test_index_shows_all_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">Note</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="s2">&quot;I am a test note&quot;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;I am a test note&lt;/p&gt;&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;note_list&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;&lt;Note: Test&gt;&#39;</span><span class="p">])</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">test_index_shows_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;I am a test note&lt;/p&gt;&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">assertQuerysetEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;note_list&#39;</span><span class="p">],</span> <span class="p">[])</span>
</span></pre></div>

<p>El primer test crea una de ejemplo en la base de datos y llama a la URL raíz (<code>/</code>). Después comprueba que la página HTML recibida está imprimiendo el contenido de la nota correctamente y que el contexto de la vista es el esperado (<code>&lt;Note: Test&gt;</code> es el resultado de evaluarse el modelo como una <em>string</em> a través del método <code>__str__</code> que sobreescribimos en el modelo).</p>
<p>El segundo test comprueba que cuando la base de datos está vacía no se imprime ninguna nota. Fíjate que el registro creado en el primer test no estará disponible en el segundo (<code>assertNotContains</code>) debido a que cada test está envuelto en una transacción que que no se llega a completar.</p>
<h3 id="ejecucion">Ejecución<a class="headerlink" href="#ejecucion" title="Permanent link">&para;</a></h3>
<p>Para ejecutar los tests, usaremos el comando <code>test</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_11" type="radio" id="__tab_11_0" checked="checked" />
<label for="__tab_11_0">Linux/UNIX</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py <span class="nb">test</span>
</pre></div></div>
<input name="__tabs_11" type="radio" id="__tab_11_1" />
<label for="__tab_11_1">Max OS X</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>python3 manage.py <span class="nb">test</span>
</pre></div></div>
<input name="__tabs_11" type="radio" id="__tab_11_2" />
<label for="__tab_11_2">Windows</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">test</span>
</pre></div></div>
</div>
<p>Veremos una salida similar a ésta:</p>
<div class="codehilite"><pre><span></span><span class="nv">Creating</span> <span class="nv">test</span> <span class="nv">database</span> <span class="k">for</span> <span class="nv">alias</span> <span class="s1">&#39;</span><span class="s">default</span><span class="s1">&#39;</span>...
<span class="nv">System</span> <span class="nv">check</span> <span class="nv">identified</span> <span class="nv">no</span> <span class="nv">issues</span> <span class="ss">(</span><span class="mi">0</span> <span class="nv">silenced</span><span class="ss">)</span>.
..
<span class="o">----------------------------------------------------------------------</span>
<span class="nv">Ran</span> <span class="mi">2</span> <span class="nv">tests</span> <span class="nv">in</span> <span class="mi">0</span>.<span class="mi">009</span><span class="nv">s</span>

<span class="nv">OK</span>
<span class="nv">Destroying</span> <span class="nv">test</span> <span class="nv">database</span> <span class="k">for</span> <span class="nv">alias</span> <span class="s1">&#39;</span><span class="s">default</span><span class="s1">&#39;</span>...
</pre></div>

<p>Fíjate que ha creado una base de datos de prueba al principio de la ejecución, y la ha destruido al terminar. Ésta base de datos es creada exclusivamente para correr los tests.</p>
<h2 id="siguientes-pasos">Siguientes pasos<a class="headerlink" href="#siguientes-pasos" title="Permanent link">&para;</a></h2>
<p>A continuación se dan algunas sugerencias para continuar aprendiendo con éste proyecto:</p>
<ul>
<li>Añadir una <a href="https://tutorial.djangogirls.org/es/template_extending/">plantilla base</a>.</li>
<li>Añadir una <a href="https://docs.djangoproject.com/es/stable/ref/models/fields/#foreignkey">clave foránea</a> en el modelo <code>Note</code> <a href="https://docs.djangoproject.com/es/stable/topics/auth/customizing/#referencing-the-user-model">al modelo <code>User</code></a>.</li>
<li>Implementar la vista <code>index</code> como una <a href="https://developer.mozilla.org/es/docs/Learn/Server-side/Django/Generic_views#Vista_(basada_en_clases)">vista basada en clases (<em>class based views</em>)</a>.</li>
</ul>
<h3 id="para-leer-mas">Para leer más<a class="headerlink" href="#para-leer-mas" title="Permanent link">&para;</a></h3>
<p>Algunos tutoriales más detallados:</p>
<ul>
<li><a href="https://docs.djangoproject.com/es/stable/intro">Django Tutorial</a>.</li>
<li><a href="https://tutorial.djangogirls.org/es/django_installation/">Django Girls Tutorial</a>.</li>
<li><a href="https://developer.mozilla.org/es/docs/Learn/Server-side/Django">Guías de Django, por Mozilla</a>.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        Creado por
        <a href="https://jorgebg.com">Jorge Barata</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="assets/fonts/font-awesome.css">
    
      <a href="https://github.com/DjangoMadrid" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/MadridDjangoUG" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.c648116f.js"></script>
      
        
        
          
          <script src="assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>